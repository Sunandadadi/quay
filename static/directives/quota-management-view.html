<div class="quota-management-view-element">

    <div ng-if="view == 'organization-view' && !configModeSelected">
        <button class="margin-2 add-quota-limit btn btn-success hidden-xs" ng-click="toggleOrgConfigView()">
            <i class="fa margin-right-4"></i>
            Add Storage Quota
        </button>
    </div>
    <div ng-if="!(view == 'organization-view' && !configModeSelected) || view == 'super-user'" class="min-width-100 co-table">
    <table class="co-table no-lines">
        <tbody>
            <tr>
                <td>
                    Set storage quota:
                </td>

                <td>
                    <input class="form-control" type="number" name="quota-limit" ng-model="currentQuotaConfig['quota']">
                </td>

                <td>

                    <select class="form-control"
                    ng-model="currentQuotaConfig['bytes_unit']"
                    ng-options="val for val in quotaUnits">
                    </select>
                </td>
                <td>
                    <button class="margin-2 add-quota-limit btn btn-success hidden-xs" ng-click="addQuotaLimit($event)">
                        <i class="fa fa-plus margin-right-4"></i>
                        Add Quota Limit
                    </button>
                </td>
            </tr>

            <tr>
                <td class="float-left">
                    Quota Policy:
                </td>
                <td>
                    <table class="co-table no-lines">
                        <thead>
                            <td>
                                <span class="capitalize-text">Quota Threshold</span>
                            </td>

                            <td>
                                <span class="capitalize-text">Action</span>
                            </td>

                            <td class="hidden-xs">
                                <span class="quota-table-head"></span>
                            </td>
                        </thead>

                        <tbody ng-model="limitCounter" ng-repeat="x in [].constructor(limitCounter) track by $index" id="limit-id-limitCounter">
                            <tr>
                                <td>
                                    <select class="form-control" name="quotaLimitType" id="quotaLimitType-{{ $index }}"
                                    ng-options="obj as obj.name for obj in quotaLimitTypes track by obj.name"
                                    ng-model="currentQuotaConfig['limits'][$index]['limit_type']">
                                    </select>
                                </td>

                                <td>
                                    <input class="form-control margin-2 min-width-171" id="quotaLimitPercent-{{ $index }}" type="number" name="limit-percent" min="1" max="100" placeholder="Limit Percent" ng-model="currentQuotaConfig['limits'][$index]['percent_of_limit']"/>
                                </td>

                                <td>
                                    <span class="margin-2 margin-left-110" ng-hide="limitCounter < 1">
                                        <button class="margin-2 btn btn-danger border-radius-50" ng-click="removeQuotaLimit($index)" ng-model="$index">
                                            <i class="fa fa-minus"></i>
                                        </button>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>

    <table class="co-table no-lines">
        <tbody>
            <tr>
                <td class="width-120px"></td>
                <td>
                    <div class="co-alert co-alert-danger" ng-if="errorMessage">
                        {{ errorMessage }}
                    </div>
                    <div class="co-help-text" ng-if="warningMessage">
                        {{ warningMessage }}
                    </div>
                </td>
            </tr>
        </tbody>
    </table>

    <table class="co-table no-lines">
        <tbody>
            <tr class="display-block">
                <td>
                    <button class="margin-2 btn btn-primary" ng-disabled="disableSave()" ng-click="updateQuotaDetailsOnSave()">Save Quota Details</button>
                </td>

                <td ng-if="view == 'organization-view' && !previousQuotaConfig['quota']">
                    <button class="margin-2 btn btn-primary" ng-click="toggleOrgConfigView()">Cancel</button>
                </td>

                <td>
                    <button class="margin-2 btn btn-danger" ng-disabled="!prevquotaEnabled" ng-click="showdeleteOrgQuota()">Remove</button>
                </td>
            </tr>
        </tbody>
    </table>
    </div>

    <!-- Delete Quota dialog -->
    <div class="cor-confirm-dialog"
        dialog-context="showQuotaDeletionModal"
        dialog-action="deleteOrgQuota(info, callback)"
        dialog-title="Really remove Quota?"
        dialog-action-title="Ok"
        dialog-form="context.deleteQuota"
        dialog-button-class="btn-danger">
        <form name="context.deleteQuota" class="co-single-field-dialog">
            <div>
                When you remove the quota storage, users can consume arbitrary amount of storage resources.
            </div>
        </form>
    </div>
</div>
